<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adicionar Item</title>
   <link rel="stylesheet" href="css/test.css">
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">
   <link rel="icon" sizes="192x192" href="https://static.wixstatic.com/media/c4bee6_f6158e93a0c04c8f9eeaba387e610940%7Emv2.png/v1/fill/w_192%2Ch_192%2Clg_1%2Cusm_0.66_1.00_0.01/c4bee6_f6158e93a0c04c8f9eeaba387e610940%7Emv2.png" type="image/png">
  <!-- Scripts -->
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

</head>

<body>
<h1>Adicionar Novo Item</h1>
  <form id="form-adicionar">

    <!-- Transportadora -->
    <div class="grupo amarelo">
      <label for="transportadora_nome">Nome Transportadora:</label>
      <input type="text" id="transportadora_nome" name="transportadora_nome" value=" TRANSKOTEMPO LTDA" readonly required>

      <label for="transportadora_cnpj">CNPJ:</label>
      <input type="text" id="transportadora_cnpj" name="transportadora_cnpj" value="59521601000192" readonly required>
    </div>

    <!-- Cliente -->
    <div class="grupo">
      <h3>Dados do Cliente</h3>
      <label for="cliente_nome">Nome:</label>
      <input type="text" id="cliente_nome" name="cliente_nome" required>

    <label for="cliente_telefone">Telefone:</label>
<input type="tel" id="cliente_telefone" name="cliente_telefone" placeholder="(DD) 9XXXX-XXXX" maxlength="15" required>
<p id="ddd-info" style="margin-top: 8px; font-weight: bold;"></p>





   <label for="email">E-mail:</label>
<input
  type="email"
  id="email"
  name="email"
  placeholder="seu.email@dominio.com"
  required
  maxlength="100"
  pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$"
  title="Digite um e-mail válido, como seu.email@dominio.com"
/>

<script>
  const emailInput = document.getElementById('email');

  emailInput.addEventListener('input', function () {
    const email = emailInput.value;
    const isValid = /^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$/.test(email);

    emailInput.style.borderColor = isValid ? '' : 'red';
  });
</script>

    </div>

    <!-- Endereço de Origem -->
    <div class="grupo amarelo">
      <h3>Endereço de Origem</h3>
      <label for="endereco_origem">Endereço:</label>
      <input type="text" id="endereco_origem" name="endereco_origem" required>

      <label for="bairro_origem">Bairro:</label>
      <input type="text" id="bairro_origem" name="bairro_origem" required>


     
<label for="cidade_origem">Cidade:</label>
      <label for="uf_origem">UF:</label>

     <div class="flex-row">
  <select id="uf-origem" name="uf_origem" required></select>
  <select id="cidade-origem" name="cidade_origem" required></select>
</div>

<!--
 <input type="text" id="cidade_origem" name="cidade_origem" required>
      <input type="text" id="uf_origem" name="uf_origem" required>
-->
     

      <div class="radio-group">
        <label><input type="radio" name="tipo_origem" value="Casa" checked> Casa</label>
        <label><input type="radio" name="tipo_origem" value="Apartamento"> Apartamento</label>
      </div>

      <div class="flex-row">
        <label for="andar_origem">Andar</label>
        <input type="number" id="andar_origem" name="andar_origem" min="0" />

        <!-- Origem -->
      <p>Elevador na origem:</p>
      </div>
           <div class="radio-group">
        <label><input type="radio" name="elevador_origem" value="sim"> Com elevador</label>
        <label><input type="radio" name="elevador_origem" value="nao"> Sem elevador</label>
     </div>
    </div>

    <!-- Endereço de Destino -->
    <div class="grupo amarelo">
      <h3>Endereço de Destino</h3>
      <label for="endereco_destino">Endereço:</label>
      <input type="text" id="endereco_destino" name="endereco_destino" required>

      <label for="bairro_destino">Bairro:</label>
      <input type="text" id="bairro_destino" name="bairro_destino" required>

      <label for="cidade_destino">Cidade:</label>
    

      <label for="uf_destino">UF:</label>

      <div class="flex-row" >
<select id="uf-destino" name="uf_destino" required></select>
  <select id="cidade-destino" name="cidade_destino" required></select>
</div>
<!--
<input type="text" id="cidade_destino" name="cidade_destino" required>
<input type="text" id="uf_destino" name="uf_destino" required>
-->
      

      <div class="radio-group">
        <label><input type="radio" name="tipo_destino" value="Casa" checked> Casa</label>
        <label><input type="radio" name="tipo_destino" value="Apartamento"> Apartamento</label>
      </div>

      <div class="flex-row">
        <label for="andar_destino">Andar</label>
        <input type="number" id="andar_destino" name="andar_destino" min="0" />
       <!-- Destino -->
       <p>Elevador no destino:</p>
 </div>
 <div class="radio-group">
    <label><input type="radio" name="elevador_destino" value="sim"> Com elevador</label>
     <label><input type="radio" name="elevador_destino" value="nao"> Sem elevador</label>
</div>
    </div>

    <!-- Itens de Mobiliário -->

<div class="grupo" style="grid-column: 1 / -1;">
  <h3>Itens de Mobiliário</h3>
  <div id="itens-container"></div>
  <button type="button" id="adicionar-item">Adicionar Móvel</button>
</div>



    <!-- Total + Observação -->
    <div class="grupo" style="grid-column: 1 / -1;">
      <label for="valor_total_declarado">Valor Total Declarado (R$):</label>
      <input type="text" id="valor_total_declarado" name="valor_total_declarado" required readonly>

      <label for="observacao">Observação:</label>
      <textarea id="observacao" name="observacao"></textarea>
    </div>

    <!-- Ações -->
    <button type="submit">Concluir</button>
    <button type="button" onclick="history.back()" class="button_red">Voltar</button>

  </form>


<script>


const DDD_LIST = [
  { ddd: "11", estado: "São Paulo", regiao: "Região Metropolitana de São Paulo / Região Metropolitana de Jundiaí / Região Geográfica Imediata de Bragança Paulista" },
  { ddd: "12", estado: "São Paulo", regiao: "Região Metropolitana do Vale do Paraíba e Litoral Norte" },
  { ddd: "13", estado: "São Paulo", regiao: "Região Metropolitana da Baixada Santista / Vale do Ribeira" },
  { ddd: "14", estado: "São Paulo", regiao: "Avaré / Bauru / Botucatu / Jaú / Lins / Marília / Ourinhos" },
  { ddd: "15", estado: "São Paulo", regiao: "Itapetininga / Itapeva / Sorocaba / Tatuí" },
  { ddd: "16", estado: "São Paulo", regiao: "Araraquara / Franca / Jaboticabal / Ribeirão Preto / São Carlos / Sertãozinho" },
  { ddd: "17", estado: "São Paulo", regiao: "Barretos / Catanduva / Fernandópolis / Jales / São José do Rio Preto / Votuporanga" },
  { ddd: "18", estado: "São Paulo", regiao: "Andradina / Araçatuba / Assis / Birigui / Dracena / Presidente Prudente" },
  { ddd: "19", estado: "São Paulo", regiao: "Americana / Campinas / Limeira / Piracicaba / Rio Claro / São João da Boa Vista" },
  { ddd: "21", estado: "Rio de Janeiro", regiao: "Rio de Janeiro e Região Metropolitana / Teresópolis" },
  { ddd: "22", estado: "Rio de Janeiro", regiao: "Cabo Frio / Campos dos Goytacazes / Itaperuna / Macaé / Nova Friburgo" },
  { ddd: "24", estado: "Rio de Janeiro", regiao: "Angra dos Reis / Petrópolis / Volta Redonda / Piraí" },
  { ddd: "27", estado: "Espírito Santo", regiao: "Vitória e Região Metropolitana / Colatina / Linhares / Santa Maria de Jetibá" },
  { ddd: "28", estado: "Espírito Santo", regiao: "Cachoeiro de Itapemirim / Castelo / Itapemirim / Marataízes" },
  { ddd: "31", estado: "Minas Gerais", regiao: "Belo Horizonte e Região Metropolitana / Conselheiro Lafaiete / Ipatinga / Viçosa" },
  { ddd: "32", estado: "Minas Gerais", regiao: "Barbacena / Juiz de Fora / Muriaé / São João del-Rei / Ubá" },
  { ddd: "33", estado: "Minas Gerais", regiao: "Almenara / Caratinga / Governador Valadares / Manhuaçu / Teófilo Otoni" },
  { ddd: "34", estado: "Minas Gerais", regiao: "Araguari / Araxá / Patos de Minas / Uberlândia / Uberaba" },
  { ddd: "35", estado: "Minas Gerais", regiao: "Alfenas / Guaxupé / Lavras / Poços de Caldas / Pouso Alegre / Varginha" },
  { ddd: "37", estado: "Minas Gerais", regiao: "Bom Despacho / Divinópolis / Formiga / Itaúna / Pará de Minas" },
  { ddd: "38", estado: "Minas Gerais", regiao: "Curvelo / Diamantina / Montes Claros / Pirapora / Unaí" },
  { ddd: "41", estado: "Paraná", regiao: "Curitiba e Região Metropolitana" },
  { ddd: "42", estado: "Paraná", regiao: "Ponta Grossa / Guarapuava" },
  { ddd: "43", estado: "Paraná", regiao: "Apucarana / Londrina" },
  { ddd: "44", estado: "Paraná", regiao: "Maringá / Campo Mourão / Umuarama" },
  { ddd: "45", estado: "Paraná", regiao: "Cascavel / Foz do Iguaçu" },
  { ddd: "46", estado: "Paraná", regiao: "Francisco Beltrão / Pato Branco" },
  { ddd: "47", estado: "Santa Catarina", regiao: "Balneário Camboriú / Blumenau / Itajaí / Joinville" },
  { ddd: "48", estado: "Santa Catarina", regiao: "Florianópolis e Região Metropolitana / Criciúma" },
  { ddd: "49", estado: "Santa Catarina", regiao: "Caçador / Chapecó / Concórdia / Lages" },
  { ddd: "51", estado: "Rio Grande do Sul", regiao: "Porto Alegre e Região Metropolitana / Santa Cruz do Sul / Litoral Norte" },
  { ddd: "53", estado: "Rio Grande do Sul", regiao: "Pelotas / Rio Grande" },
  { ddd: "54", estado: "Rio Grande do Sul", regiao: "Caxias do Sul / Passo Fundo" },
  { ddd: "55", estado: "Rio Grande do Sul", regiao: "Santa Maria / Santana do Livramento / Santo Ângelo / Uruguaiana" },
  { ddd: "61", estado: "Distrito Federal/Goiás", regiao: "Todo o Distrito Federal e alguns municípios da RIDE" },
  { ddd: "62", estado: "Goiás", regiao: "Goiânia e Região Metropolitana / Anápolis / Niquelândia / Porangatu" },
  { ddd: "63", estado: "Tocantins", regiao: "Todo o estado" },
  { ddd: "64", estado: "Goiás", regiao: "Caldas Novas / Catalão / Itumbiara / Rio Verde" },
  { ddd: "65", estado: "Mato Grosso", regiao: "Cuiabá e Região Metropolitana" },
  { ddd: "66", estado: "Mato Grosso", regiao: "Rondonópolis / Sinop" },
  { ddd: "67", estado: "Mato Grosso do Sul", regiao: "Todo o estado" },
  { ddd: "68", estado: "Acre", regiao: "Todo o estado" },
  { ddd: "69", estado: "Rondônia", regiao: "Todo o estado" },
  { ddd: "71", estado: "Bahia", regiao: "Salvador e Região Metropolitana" },
  { ddd: "73", estado: "Bahia", regiao: "Eunápolis / Ilhéus / Porto Seguro / Teixeira de Freitas" },
  { ddd: "74", estado: "Bahia", regiao: "Irecê / Jacobina / Juazeiro / Xique-Xique" },
  { ddd: "75", estado: "Bahia", regiao: "Alagoinhas / Feira de Santana / Paulo Afonso / Valença" },
  { ddd: "77", estado: "Bahia", regiao: "Barreiras / Bom Jesus da Lapa / Guanambi / Vitória da Conquista" },
  { ddd: "79", estado: "Sergipe", regiao: "Todo o estado" },
  { ddd: "81", estado: "Pernambuco", regiao: "Recife e Região Metropolitana / Caruaru" },
  { ddd: "82", estado: "Alagoas", regiao: "Todo o estado" },
  { ddd: "83", estado: "Paraíba", regiao: "Todo o estado" },
  { ddd: "84", estado: "Rio Grande do Norte", regiao: "Todo o estado" },
  { ddd: "85", estado: "Ceará", regiao: "Fortaleza e Região Metropolitana" },
  { ddd: "86", estado: "Piauí", regiao: "Teresina e Grande Teresina / Parnaíba" },
  { ddd: "87", estado: "Pernambuco", regiao: "Garanhuns / Petrolina / Salgueiro / Serra Talhada" },
  { ddd: "88", estado: "Ceará", regiao: "Juazeiro do Norte / Sobral" },
  { ddd: "89", estado: "Piauí", regiao: "Picos / Floriano" },
  { ddd: "91", estado: "Pará", regiao: "Belém e Região Metropolitana" },
  { ddd: "92", estado: "Amazonas", regiao: "Manaus / Região Metropolitana / Parintins" },
  { ddd: "93", estado: "Pará", regiao: "Santarém / Altamira" },
  { ddd: "94", estado: "Pará", regiao: "Marabá" },
  { ddd: "95", estado: "Roraima", regiao: "Todo o estado" },
  { ddd: "96", estado: "Amapá", regiao: "Todo o estado" },
  { ddd: "97", estado: "Amazonas", regiao: "Interior do estado" },
  { ddd: "98", estado: "Maranhão", regiao: "São Luís e Região Metropolitana" },
  { ddd: "99", estado: "Maranhão", regiao: "Caxias / Codó / Imperatriz" }
];


  const telefoneInput = document.getElementById('cliente_telefone');

  telefoneInput.addEventListener('input', function (e) {
    let value = telefoneInput.value.replace(/\D/g, '');

    // Limita a 11 dígitos (2 DDD + 9 número)
    if (value.length > 11) value = value.slice(0, 11);

    // Aplica a máscara
    let formatted = value;

    if (value.length > 0) {
      formatted = `(${value.slice(0, 2)}`;
    }
    if (value.length >= 3) {
      formatted += `) ${value.slice(2, 7)}`;
    }
    if (value.length >= 8) {
      formatted += `-${value.slice(7)}`;
    }

    telefoneInput.value = formatted;
  });

  // Impede que o usuário trave ao apagar parênteses ou traço
  telefoneInput.addEventListener('keydown', function (e) {
    const key = e.key;
    if ((key === 'Backspace' || key === 'Delete')) {
      const cursor = telefoneInput.selectionStart;
      const prevChar = telefoneInput.value[cursor - 1];

      if (['(', ')', '-', ' '].includes(prevChar)) {
        // Pula o caractere formatador ao apagar
        telefoneInput.setSelectionRange(cursor - 1, cursor - 1);
      }
    }
  });

 const dddInfo = document.getElementById('ddd-info');

  telefoneInput.addEventListener('input', function () {
    const ddd = telefoneInput.value.replace(/\D/g, '').slice(0, 2);
    const entry = DDD_LIST.find(item => item.ddd === ddd);

    if (entry) {
      dddInfo.textContent = `${entry.estado} - ${entry.regiao}`;
    } else {
      dddInfo.textContent = '';
    }
  });

</script>

    
  <script type="module" src="js/script.js"></script>


<script>
const elevador_origem = document.querySelector('input[name="elevador_origem"]:checked')?.value || "nao";
const elevador_destino = document.querySelector('input[name="elevador_destino"]:checked')?.value || "nao";
console.log("Origem:", elevador_origem);  // "sim" ou "nao"
console.log("Destino:", elevador_destino);  // "sim" ou "nao"
</script>

  <script>

    const descricoesPorCategoria = {
    "ESTAR E JANTAR": [
    "Abajour", "Aparelho-Som", "Ar-Condicionado", "Arranjos-Ornamentais", "Banco-Piano", "Banqueta", "Bar", "Biombo", 
    "Buffet-Pequeno", "Buffet-Grande", "Buffet-com-Cristal", "CD", "Cadeira-Balanço", "Cadeira-de-Braço", "Cadeira-de-Criança", 
    "Cadeira-Simples", "Caixa-de-Som-Peq", "Caixa-de-Som-Gde", "Carrinho-de-Cha", "Console", "Cristaleira", "Discos", 
    "DVD-Player", "DVD", "Espelhos", "Estante-Alta", "Estante-Baixa", "Lustre-Luminaria", "Mármore-Granito", "Mesa-de-Centro", 
    "Mesa-Dobravel", "Mesa-Elastica", "Mesa-Jantar", "Mesa-Lateral", "Mesa-de-Telefone", "Mesa-TV", "Piano-Armario", "Piano-Apartamento", "Piano-Cauda", "Poltrona", 
    "Rack", "Radio", "Relogio-de-Parede", "Sofa-2-Almofadas", "Sofa-3-Almofadas", "Sofa-4-Almofadas", 
    "Tapete-Pequeno", "Tapete-Grande", "TV-Preto-e-Branco", "TV-Cores", "Vídeo-Cassete", "Vidro-Mesa"
  ],
  "DORMITÓRIO": [
    "Arca-Baú", "Ar-Condicionado", "Armário-2-Portas", "Armário-3-Portas", "Armário-4-Portas", "Armário-Duplex", "Cama-Beliche", 
    "Cama-Berço", "Cama-Casal", "Cama-Criança", "Cama-Solteiro", "Cama-Dobrável", "Carrinho-Bebê", "Cesto-para-Roupas", "Colchão-Berço", "Colchão-Casal", 
    "Colchão-Solteiro", "Cômoda-Penteadeira", "Mala-Pequena", "Mala-Grande", "Maquina-Costura", "Mesa-Cabeceira", "Sofa-Cama"
  ],
  "ESCRITÓRIO": [
    "Armário-de-Aço", "Arquivo", "Cadeira-Estofada", "Calculadora-Manual", "Calculadora-Elétrica", "Calculadora-Eletrônica",  "Cofre",
    "Computador", "Escrivaninha-Grande", "Escrivaninha-Pequena", "Escrivaninha-em-L", "Estante-Madeira", "Estante-Aço", "Formulários-DVS", "Impressora", "Máquina-de-Escrever", 
    "Máquina-Elétrica","Material-Escritorio", "Mesa-de-Reunião", "Monitor"
  ],
  "COZINHA / ÁREA": [
    "Aquecedor", "Armário-Alto", "Armário-Baixo", "Armário-Parede", "Balança","Batedeira","Botijao-de-Gas", "Enceradeira",  "Espremedor", "Exaustor",
   "Forno" , "Filtro", "Fogão", "Freezer", "Geladeira", "Lava-Louças", "Lava-Roupas", "Liquidificador", "Mesa", "Microondas", "Moedor", "Secadora",
   "Sucata"
    
  ],
  "DIVERSOS": [
    "Artigos-Esportivos","Aspirador-de-Pó", "Bebidas-Lacradas", "Bicicleta","Máquina-de-Lavar", "Cortinas", "Cristais", "Esculturas", "Ferramentas", "Filmadora",
     "Instrumentos-Musicais", "Livros", "Louças", "Objeto-Uso-Pessoal", "Perfume-Maq", "Porcelana", "Prataria", "Projetor", "Quadros-e-Telas", "Roupas-Pessoais", "Cama","Mesa", "Banho"
   
  ],
  "VEÍCULOS": [
    "Automovel", "Moto"
  ],
  "OUTROS (ESPECIFICAR ABAIXO)":
  [
    "Nada"
  ]
}
;
   

    function atualizarDescricoes(categoriaSelect, descricaoSelect) {
        const categoria = categoriaSelect.value;
        descricaoSelect.innerHTML = '<option value="">Selecione uma descrição</option>';
        if (categoria in descricoesPorCategoria) {
            descricoesPorCategoria[categoria].forEach(descricao => {
                descricaoSelect.innerHTML += `<option value="${descricao}">${descricao}</option>`;
            });
        }
    }

    function calcularValorTotal() {
        const valores = document.querySelectorAll('input[name="movel_valor[]"]');
        let total = 0;

        valores.forEach(valor => {
            const valorFormatado = valor.value.replace(/[^\d]/g, '');
            const valorNumerico = parseFloat(valorFormatado) / 100;
            if (!isNaN(valorNumerico)) {
                total += valorNumerico;
            }
        });

        document.getElementById('valor_total_declarado').value = total.toLocaleString('pt-BR', {
            minimumFractionDigits: 2,
            maximumFractionDigits: 2
        });
    }

   function formatarValor(input) {
  const onlyDigits = input.value.replace(/[^\d]/g, '');
  const number = parseFloat(onlyDigits) / 100;
  if (!isNaN(number)) {
    input.value = number.toLocaleString('pt-BR', {
      style: 'currency',
      currency: 'BRL'
    });
  } else {
    input.value = '';
  }
  calcularValorTotal();
}

   let contadorItens = 0;

document.getElementById('adicionar-item').onclick = function () {
    const container = document.getElementById('itens-container');
    const newItem = document.createElement('div');
    newItem.className = 'item';
    const id = contadorItens++;

    newItem.innerHTML = `
        <label>Categoria:</label>
        <select name="movel_categoria[]" required>
            <option value="">Selecione uma categoria</option>
            <option value="ESTAR E JANTAR">ESTAR E JANTAR</option>
            <option value="DORMITÓRIO">DORMITÓRIO</option>
            <option value="ESCRITÓRIO">ESCRITÓRIO</option>
            <option value="COZINHA / ÁREA">COZINHA / ÁREA</option>
            <option value="DIVERSOS">DIVERSOS</option>
            <option value="VEÍCULOS">VEÍCULOS</option>
            <option value="OUTROS (ESPECIFICAR ABAIXO)">OUTROS (ESPECIFICAR ABAIXO)</option>
            
        </select>

        <label>Descrição do Móvel:</label>
        <select name="movel_descricao[]" required>
            <option value="">Selecione uma descrição</option>
        </select>

        <label>Quantidade:</label>
        <input type="number" name="movel_quantidade[]" required>

        <label>Valor (R$):</label>
        <input type="text" name="movel_valor[]" required oninput="formatarValor(this)" placeholder="R$ 0,00">

        <label>Estado do Item:</label>
        <div class="radio-group">
            <label><input type="radio" name="ep_${id}" value="1"> Desmontado</label>
            <label><input type="radio" name="ep_${id}" value="2"> Embalada</label>
            <label><input type="radio" name="ep_${id}" value="3"> Amassado</label>
            <label><input type="radio" name="ep_${id}" value="4"> Normal</label>
            <label><input type="radio" name="ep_${id}" value="5"> Arranhado</label>
            <label><input type="radio" name="ep_${id}" value="6"> Solto</label>
        </div>

        <input type="hidden" name="movel_estado[]" value="">

        <button type="button" class="remover-item">Remover</button>
    `;

    container.appendChild(newItem);

    const categoriaSelect = newItem.querySelector('select[name="movel_categoria[]"]');
    const descricaoSelect = newItem.querySelector('select[name="movel_descricao[]"]');
    const estadoInput = newItem.querySelector('input[name="movel_estado[]"]');

    categoriaSelect.onchange = () => atualizarDescricoes(categoriaSelect, descricaoSelect);

    newItem.querySelectorAll(`input[type="radio"][name="ep_${id}"]`).forEach(radio => {
        radio.onchange = () => {
            if (radio.checked) estadoInput.value = radio.value;
        };
    });

    newItem.querySelector('.remover-item').onclick = () => {
        container.removeChild(newItem);
        calcularValorTotal();
    };
};

// Adiciona o primeiro item automaticamente
document.getElementById('adicionar-item').click();
    // Inicializa o primeiro item
    const firstCategoriaSelect = document.querySelector('select[name="movel_categoria[]"]');
    const firstDescricaoSelect = document.querySelector('select[name="movel_descricao[]"]');
    if (firstCategoriaSelect && firstDescricaoSelect) {
        firstCategoriaSelect.onchange = () => atualizarDescricoes(firstCategoriaSelect, firstDescricaoSelect);
    }

    document.getElementById('form-adicionar').onsubmit = async function (event) {
        event.preventDefault();
        const loadingMessage = document.createElement('div');
        loadingMessage.textContent = 'Adicionando item...';
        document.body.appendChild(loadingMessage);

        const formData = new FormData(event.target);
        const data = {
            transportadora: {
                nome: "TRANSKOTEMPO LTDA",
                cnpj: "59521601000192"
            },
            cliente: {
                nome: formData.get('cliente_nome'),
                telefone: formData.get('cliente_telefone'),
                endereco_origem: {
                    endereco: formData.get('endereco_origem'),
                    bairro: formData.get('bairro_origem'),
                    cidade: formData.get('cidade_origem'),
                    uf: formData.get('uf_origem'),
                    complemento_origem: formData.get('tipo_origem'),
                    andar_origem : formData.get('andar_origem'),
                    elevador_origem: formData.get('elevador_origem'),
                },
                endereco_destino: {
                    endereco: formData.get('endereco_destino'),
                    bairro: formData.get('bairro_destino'),
                    cidade: formData.get('cidade_destino'),
                    uf: formData.get('uf_destino'),
                    complemento_destino: formData.get('tipo_destino'),
                    andar_destino: formData.get('andar_destino'),
                    elevador_destino: formData.get('elevador_destino'),
                }
            },
            itens: Array.from(formData.getAll('movel_descricao[]')).map((descricao, i) => ({
                categoria: formData.getAll('movel_categoria[]')[i],
                descricao,
                quantidade: parseInt(formData.getAll('movel_quantidade[]')[i]),
                valor: parseFloat(formData.getAll('movel_valor[]')[i].replace(/[^\d]/g, '')) / 100,
                estado: formData.getAll('movel_estado[]')[i]
            })),
            valor_total_declarado: parseFloat(formData.get('valor_total_declarado').replace(/[^\d]/g, '')) / 100,
            observacao: formData.get('observacao'),
            data_local: new Date().toISOString(),
            assinaturas: {
                transportador: "",
                cliente: formData.get('cliente_nome'),
                email: formData.get('email'),
            }
        };

        try {
            const response = await fetch('/adicionar', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });

            loadingMessage.remove();
            if (!response.ok) throw new Error('Erro ao adicionar item.');
            const responseData = await response.json();
            window.location.href = 'index.html';

        } catch (error) {
            loadingMessage.remove();
            alert('Erro: ' + error.message);
        }
    };


document.addEventListener('DOMContentLoaded', () => {
  const categoriaSelect = document.querySelector('select[name="movel_categoria[]"]');
  const descricaoSelect = document.querySelector('select[name="movel_descricao[]"]');

  categoriaSelect.addEventListener('change', () => {
    atualizarDescricoes(categoriaSelect, descricaoSelect);
  });

  // Evento para calcular valor total ao digitar valores
  document.querySelectorAll('input[name="movel_valor[]"]').forEach(input => {
    input.addEventListener('input', calcularValorTotal);
  });

  // Evento para remover item
  document.addEventListener('click', function(e) {
    if (e.target.classList.contains('remover-item')) {
      e.target.closest('.item').remove();
      calcularValorTotal();
    }
  });
});


</script>

  
      <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <script>
        AOS.init();
    </script>
      <script type="module" src="js/cidade-estados-brasil.js"></script>
</body>
</html>